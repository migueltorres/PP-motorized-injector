# PP-motorized-injector
Motorized plastic injector using Arduino code to be open sourced with Precious Plastic initiative once working!

I create this (1st time on Github!) repo as I would like help in getting this finished and resolving issues that I am having (please excuse the extension of the descripcion, I am not known for my ability to summerize!):

I am making a PP influenced style injector, but controlled with Arduino to be able to send a Nema 34 160mm with Encoder, with 1:20 reduction to a 26mm ID / 50cm stroke injection barrel with control enough to be able to inject up to a 1/10th of a cm3 of plastic (more or less, the actual system is capable of even btter precision, but plastic is a dynamic fluid so don't expect the practice to reflect the theory 100%).. this need came about because the manual arbour version I made is so powerful that it injects great into large thick 3D moulds, but is difficult to fill smaller 2D moulds made from 8mm sandwich (originally these were a good format for the first lever-operated PP injector), as it is too easy to overfill and get flash, and then is very difficult to open the 2D mould and the part is ruined,.. and the smaller the part to inject, the more difficult it is to "feel" when it is full and to tehn over-fill - this machine should be able to calibrate to each mould the exact amount and speed of injection to get a perfect fill each time ðŸ¤ž

I have done the mechanical design (still open to a couple of last minute choices about things like how to detect the presence of the mould/ nozzle blocking mech/ barrel blocking mech, etc) and believe it to be quite solid, as I have designed a few machines myself (https://bazar.preciousplastic.com/andys-recycling-machines/), including an arbour injector before the PP version came out.. I had asked for help documenting this to open source the design as this is a weak point for me, but didn't get much response ðŸ¤·, hopefully this time can get the help I need on the software side.. this is supposed to be open sourced as well..  

the machine for me should be able to inject into any type of mould, up to a maximum size (the space under the nozzle), and volumen (supposedly about 265cm3, pratice this will be about 200cm3 as the cold flakes have air), and different size moulds basically have a wooden block under them to make up the space needed so they are all at the same height, so to speak...  I generally inject max about 50-60cm3 with the manual machine, which has slightly smaller volumen (about 180cm3) and Refill after each injection

I have so far managed to integrate (inductive) endstops for top and bottom plunger movement, a barrel slip detection (my method on my manual injector of stopping heat from passing from the barrel to the rest of the machine, and so to be more efficient, is to clamp the barrel between 2 offset clamps, and the space is filled with cork sheet, works very well and the clamps do not get hot, but if the machine is incorrectly used and the plunger forced with nothing underneath the barrel, happens with the manual version too, then the barrel can clip in the clamp, changing the space below/calibration of the injection process), temp in nozzle detection (low temp, no move), and a 3 button LED backlit keypad at the height of the Nozzle to aid use of the machine when working down there (purging, zeroing for injection, injection itself, colores change and functions of each button)... all running on a ESP32 exclusively dedicated to running the motor, encoder, endstops, etc.

The other half of the electronics is a 2nd ESP32 Touchscreen display, connected to the motor ESP32 via UART, where can graphically add mould profiles, change parameters, store and load a list of moulds, and also graphically show the contents of the barrel; how much time each Refill has been in the barrel (during Production with the manual injector, I Refill after each Injection, but have to give time for each Refill Block to heat up as it travels down the barrel, so it has had time enough to reach melt temp before being injected, otherwie get a cold injection), once calibrated with a minTime can advise that the NextInjection amount and the RefillBlock at present about to be injected both pass in TimeHeated and amount to inject, to make sure that it will not be too cold.. everything is stored on this Display in flash, and only the NextInjection parameters are sent to the motor ESP32 via UART...  these are mould variables that change with each mould, there are also a load more common machine variables that are changeable from the display, like offsets from endstops, speeds and amounts of a compression function with auto-detection of max compression (the Nema will skip, the Encoder Compare function will notice this and reduce/stop compression), which once set up will rarely have to be changed/tuned

So far I have checked that each electronic component works with simple separate test sketches directly to the motor ESP.. the Display ESP I am still in the GUI design stage, using EEZ Studio (first time too, so learning curve ðŸ˜œ), but eventually will have to be connected, but until this 2nd stage is done, the same serial info should be able to be sent via Serial to change mould parameters, then all workings of the machine, following a State Machine programming style, will be possible from the 3 keypad control, as each State will give different options to the buttons to proceed or go back to other States as needed...


Here in this repo I have uploaded all notes, design considerations, and so far a few captures of the machine, and my next steps I hope to generate interest on the Discord server (which also rarely useðŸ˜¬).. I am 52 years old, completely self-learnt in all I have ever been interested in since I left home at 15 years old, so am very aware that what I do know is out-weighed by what I don't know in most of what I am learnt in life.. I am level 1 autistic, but intelligent enough to have masked most of my life until I auto-diagnosed about 6-7 years ago.. I personally do not like social networks, but aim to use Discord to learn from others and help try and get this machine up and running ASAP.. I have tried using ChatGPT with varing levels of success in getting every more complex sketches working (tab separated sketches seem to be my limit, can't seem to get more than the most basic ones working, when I understand that need to have a more modular approach with more tab separated header files, but here is were I have reached my limit!), but am also self-employed and PP here in Tenerife is not big enough to be able to dedicate all of my time, so I have other professional obligations that take time away from this proyect ðŸ¤·

I am not entirely sure about how to best proceed in questions of organisation via Discord, how to better use Github to centralize development of this proyect to benefit everyone in PP with this machine that I hope will open up easy injection to more people, but after seeing the latest video about PP problems and need to get to v5, I would like to make this public/ open source now (have been working over a year on this, on and off, and have the alpha built and waiting for a working sketch!)

I would need help integrating the State Machine I have designed into a working sketch, capable of responding to user button presses, and updating the ActualMould struct via Serial monitor to be able to change easier the MouldVariables (instead of having to reflash each time), and finalizing the way of detection for Compresion (nozzle blocking), Purging (barrel blocking but nozzle open, small forces to purge and check that plastic is ready for injection), and Injection (same, but now using the full force for the programed move to fill the mould).. am contemplating now placing Strain gauges below the injection platform (will see how much strain is registable as I made this area pretty solid to be able to resist the injection pressure, about 1500kgs estimated), and/or Time of Flight distance sensors next to the nozzle to "see" that there is something that should block the barrel, and considering intergrating a couple of current sensors in one of the Nema motor pairs (SimpleFOC style, but my driver (for this hardware version) is "step/dir", so cannot use SimpleFOC) to detect peaks (or lack of) motor current that may help me indicate build up of pressure that could show there is / is not something below the barrel..

Please revise the contents of the repo, advise on what else is needed here, info to understand better the machine/concept, etc, and if someone on Discord could help maybe make a thread/channel (I think it is called that..?) to organise and separate interest on advancing this proyect, that would be a big help too...

google sheets (exported from Numbers ðŸ˜¬) of BoM, calcs, and particularly the State Machine.. although can't remember when did this export..
https://docs.google.com/spreadsheets/d/1dTpOeWWeW3WKA8ZfMgRmvt531EJANU4MFCuCA3LTdP0/edit?usp=sharing

Thanks in advance, I feel I am a pretty good mechanic, my "tok" is getting machines to work (my manual machines work pretty well), but software, although have a few years unfer the belt am learning and can follow quite well in ArduinoIDE (PlatformIO is still a bit more of a mistery for me, hace tried and not got good results yet..), getting a more complex sketch like this to integrate is driving me a little crazy!
